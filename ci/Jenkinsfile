pipeline {
    agent any

   tools {
    maven 'Maven - 3.9.9'
    jdk 'JDK-17'
}

    triggers {
        cron('0 3 * * *')  // Runs every day at 9:00 AM IST (3:30 AM UTC)
    }

    stages {
        stage('Test Suite 1') {
            steps {
                echo 'Running testng-master.xml'
                sh 'mvn clean test -DsuiteXmlFile=src/test/resources/suites/ui-suites/testng-master.xml'
            }
        }

        stage('Test Suite 2') {
            steps {
                echo 'Running testng-parallel.xml'
                sh 'mvn clean test -DsuiteXmlFile=src/test/resources/suites/ui-suites/testng-parallel.xml'
            }
        }
    }

 post {
    always {
        // âœ… 1. Archive the whole report folder for download (optional but good)
        archiveArtifacts artifacts: 'reports/**', fingerprint: true

        // âœ… 2. Publish the full HTML report with required styles
        publishHTML([
            allowMissing: false,                 // ğŸ”’ Fail if file is missing
            alwaysLinkToLastBuild: true,         // ğŸ” Always show latest report
            keepAll: true,                       // ğŸ—‚ Keep old reports too
            reportDir: 'reports',                // ğŸ“ Folder where report is generated
            reportFiles: 'ExtentReport.html',    // ğŸ“„ Main HTML file to open
            reportName: 'Extent Report'          // ğŸ“Œ Display name in Jenkins
        ])
    }
}

}
